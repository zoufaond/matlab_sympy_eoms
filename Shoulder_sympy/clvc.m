function xd = clvc(t, x, g,m, I, com, c)

icxx = I(1);
icyy = I(2);
iczz = I(3);
ixy = I(6);
iyz = I(4);
izx = I(5);
comx = com(1);
comy = com(2);
comz = com(3);
c1 = c(1);
c2 = c(2);
c3 = c(3);

q1 = x(1);
q2 = x(2);
q3 = x(3);
u1 = x(4);
u2 = x(5);
u3 = x(6);

xd = zeros(6,1);
% 
mm = [
1, 0, 0,                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                       0;
0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                       0;
0, 0, 1,                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                                       0;
0, 0, 0, m*((comx*sin(q2) - comz*cos(q2)*cos(q3))^2 + (-comy*sin(q2) - comz*sin(q3)*cos(q2))^2 + (comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))^2) + (iczz*sin(q2) - iyz*sin(q3)*cos(q2) + izx*cos(q2)*cos(q3))*sin(q2) + (icxx*cos(q2)*cos(q3) - ixy*sin(q3)*cos(q2) + izx*sin(q2))*cos(q2)*cos(q3) - (-icyy*sin(q3)*cos(q2) + ixy*cos(q2)*cos(q3) + iyz*sin(q2))*sin(q3)*cos(q2), m*(-comz*(comx*sin(q2) - comz*cos(q2)*cos(q3))*sin(q3) + comz*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*cos(q3) + (-comx*cos(q3) + comy*sin(q3))*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))) + (icxx*cos(q2)*cos(q3) - ixy*sin(q3)*cos(q2) + izx*sin(q2))*sin(q3) + (-icyy*sin(q3)*cos(q2) + ixy*cos(q2)*cos(q3) + iyz*sin(q2))*cos(q3), iczz*sin(q2) - iyz*sin(q3)*cos(q2) + izx*cos(q2)*cos(q3) + m*(comx*(comx*sin(q2) - comz*cos(q2)*cos(q3)) - comy*(-comy*sin(q2) - comz*sin(q3)*cos(q2)));
0, 0, 0,                                            m*(-comz*(comx*sin(q2) - comz*cos(q2)*cos(q3))*sin(q3) + comz*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*cos(q3) + (-comx*cos(q3) + comy*sin(q3))*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))) + (icxx*sin(q3) + ixy*cos(q3))*cos(q2)*cos(q3) - (icyy*cos(q3) + ixy*sin(q3))*sin(q3)*cos(q2) + (iyz*cos(q3) + izx*sin(q3))*sin(q2),                                                                                                                                                                           m*(comz^2*sin(q3)^2 + comz^2*cos(q3)^2 + (-comx*cos(q3) + comy*sin(q3))^2) + (icxx*sin(q3) + ixy*cos(q3))*sin(q3) + (icyy*cos(q3) + ixy*sin(q3))*cos(q3),                                                                                  iyz*cos(q3) + izx*sin(q3) + m*(-comx*comz*sin(q3) - comy*comz*cos(q3));
0, 0, 0,                                                                                                                                                                                                                     iczz*sin(q2) - iyz*sin(q3)*cos(q2) + izx*cos(q2)*cos(q3) + m*(comx*(comx*sin(q2) - comz*cos(q2)*cos(q3)) - comy*(-comy*sin(q2) - comz*sin(q3)*cos(q2))),                                                                                                                                                                                                                                                                  iyz*cos(q3) + izx*sin(q3) + m*(-comx*comz*sin(q3) - comy*comz*cos(q3)),                                                                                                                            iczz + m*(comx^2 + comy^2)];

fo = [
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           u1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           u2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           u3;
-c1*u1*cos(q2)*cos(q3) + c2*u2*sin(q3)*cos(q2) - c3*u3*sin(q2) - g*m*(comx*sin(q2) - comz*cos(q2)*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - g*m*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)) + g*m*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))*sin(q1)*cos(q2) - m*(comx*sin(q2) - comz*cos(q2)*cos(q3))*(comx*u1*u2*cos(q2) - comz*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(u1*sin(q2) + u3)) - m*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*(-comy*u1*u2*cos(q2) + comz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*sin(q2) + u3) + (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - m*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))*(-comx*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + comy*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) - (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (icxx*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + ixy*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + izx*u1*u2*cos(q2) - (u1*sin(q2) + u3)*(icyy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + ixy*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + iyz*(u1*sin(q2) + u3)) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(iczz*(u1*sin(q2) + u3) + iyz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*cos(q2)*cos(q3) + u2*sin(q3))))*cos(q2)*cos(q3) + (icyy*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + ixy*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + iyz*u1*u2*cos(q2) + (u1*sin(q2) + u3)*(icxx*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + ixy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*sin(q2) + u3)) - (u1*cos(q2)*cos(q3) + u2*sin(q3))*(iczz*(u1*sin(q2) + u3) + iyz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*cos(q2)*cos(q3) + u2*sin(q3))))*sin(q3)*cos(q2) - (iczz*u1*u2*cos(q2) + iyz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + izx*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(icxx*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + ixy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*sin(q2) + u3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(icyy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + ixy*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + iyz*(u1*sin(q2) + u3)))*sin(q2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             -c1*u1*sin(q3) - c2*u2*cos(q3) + comz*g*m*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3) - comz*g*m*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q3) + comz*m*(comx*u1*u2*cos(q2) - comz*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(u1*sin(q2) + u3))*sin(q3) - comz*m*(-comy*u1*u2*cos(q2) + comz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*sin(q2) + u3) + (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*cos(q3) + g*m*(-comx*cos(q3) + comy*sin(q3))*sin(q1)*cos(q2) - m*(-comx*cos(q3) + comy*sin(q3))*(-comx*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + comy*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) - (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (icxx*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + ixy*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + izx*u1*u2*cos(q2) - (u1*sin(q2) + u3)*(icyy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + ixy*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + iyz*(u1*sin(q2) + u3)) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(iczz*(u1*sin(q2) + u3) + iyz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*cos(q2)*cos(q3) + u2*sin(q3))))*sin(q3) - (icyy*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + ixy*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + iyz*u1*u2*cos(q2) + (u1*sin(q2) + u3)*(icxx*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + ixy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*sin(q2) + u3)) - (u1*cos(q2)*cos(q3) + u2*sin(q3))*(iczz*(u1*sin(q2) + u3) + iyz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*cos(q2)*cos(q3) + u2*sin(q3))))*cos(q3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -c3*u3 - comx*g*m*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - comx*m*(comx*u1*u2*cos(q2) - comz*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(u1*sin(q2) + u3)) + comy*g*m*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)) + comy*m*(-comy*u1*u2*cos(q2) + comz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*sin(q2) + u3) + (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - iczz*u1*u2*cos(q2) - iyz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - izx*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(icxx*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + ixy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + izx*(u1*sin(q2) + u3)) - (u1*cos(q2)*cos(q3) + u2*sin(q3))*(icyy*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + ixy*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + iyz*(u1*sin(q2) + u3))];
%%

%% inertia vuci ceilingu
% mm = [
% 1, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0;
% 0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0;
% 0, 0, 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    0;
% 0, 0, 0, m*((comx*sin(q2) - comz*cos(q2)*cos(q3))^2 + (-comy*sin(q2) - comz*sin(q3)*cos(q2))^2 + (comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))^2) + (icxx*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + ixy*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + izx*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)))*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + (icyy*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + ixy*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)))*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + (iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)) + iyz*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + izx*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2))*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)), m*(-comz*(comx*sin(q2) - comz*cos(q2)*cos(q3))*sin(q3) + comz*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*cos(q3) + (-comx*cos(q3) + comy*sin(q3))*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))) + ((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3))*(iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)) + iyz*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + izx*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2)) + ((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3))*(icyy*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + ixy*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2))), m*(comx*(comx*sin(q2) - comz*cos(q2)*cos(q3)) - comy*(-comy*sin(q2) - comz*sin(q3)*cos(q2))) + (icxx*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + ixy*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + izx*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)))*sin(q2) - (icyy*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + ixy*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)))*sin(q1)*cos(q2) + (iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)) + iyz*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + izx*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2))*cos(q1)*cos(q2);
% 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                         m*(-comz*(comx*sin(q2) - comz*cos(q2)*cos(q3))*sin(q3) + comz*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*cos(q3) + (-comx*cos(q3) + comy*sin(q3))*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))) + (icyy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)))*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + (iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)) + iyz*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)))*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)) + (ixy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)) + izx*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)))*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2),                                                                                                                                                                                                                                                                                                                                                                                                                              m*(comz^2*sin(q3)^2 + comz^2*cos(q3)^2 + (-comx*cos(q3) + comy*sin(q3))^2) + (icyy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)))*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)) + (iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)) + iyz*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)))*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            m*(-comx*comz*sin(q3) - comy*comz*cos(q3)) - (icyy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)))*sin(q1)*cos(q2) + (iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)) + iyz*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)))*cos(q1)*cos(q2) + (ixy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3)) + izx*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3)))*sin(q2);
% 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m*(comx*(comx*sin(q2) - comz*cos(q2)*cos(q3)) - comy*(-comy*sin(q2) - comz*sin(q3)*cos(q2))) + (icxx*sin(q2) - ixy*sin(q1)*cos(q2) + izx*cos(q1)*cos(q2))*(sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2) + (-icyy*sin(q1)*cos(q2) + ixy*sin(q2) + iyz*cos(q1)*cos(q2))*(-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2)) + (iczz*cos(q1)*cos(q2) - iyz*sin(q1)*cos(q2) + izx*sin(q2))*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m*(-comx*comz*sin(q3) - comy*comz*cos(q3)) + ((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3))*(iczz*cos(q1)*cos(q2) - iyz*sin(q1)*cos(q2) + izx*sin(q2)) + ((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3))*(-icyy*sin(q1)*cos(q2) + ixy*sin(q2) + iyz*cos(q1)*cos(q2)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                m*(comx^2 + comy^2) + (icxx*sin(q2) - ixy*sin(q1)*cos(q2) + izx*cos(q1)*cos(q2))*sin(q2) - (-icyy*sin(q1)*cos(q2) + ixy*sin(q2) + iyz*cos(q1)*cos(q2))*sin(q1)*cos(q2) + (iczz*cos(q1)*cos(q2) - iyz*sin(q1)*cos(q2) + izx*sin(q2))*cos(q1)*cos(q2)];
% 
% fo = [
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             u1;
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             u2;
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             u3;
% -c1*u1*cos(q2)*cos(q3) + c2*u2*sin(q3)*cos(q2) - c3*u3*sin(q2) - g*m*(comx*sin(q2) - comz*cos(q2)*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - g*m*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)) + g*m*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))*sin(q1)*cos(q2) - m*(comx*sin(q2) - comz*cos(q2)*cos(q3))*(comx*u1*u2*cos(q2) - comz*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(u1*sin(q2) + u3)) - m*(-comy*sin(q2) - comz*sin(q3)*cos(q2))*(-comy*u1*u2*cos(q2) + comz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*sin(q2) + u3) + (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - m*(comx*sin(q3)*cos(q2) + comy*cos(q2)*cos(q3))*(-comx*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + comy*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) - (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - ((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*cos(q2)*cos(q3) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*sin(q3)*cos(q2) + sin(q2)*cos(q1)*cos(q2))*(iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + iyz*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + izx*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + (2*iyz*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + 2*izx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (icxx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ixy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (icyy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + iyz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3))*(icxx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + iczz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iyz*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))) + (-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)))*(icyy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iczz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + ixy*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))))) - (-(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3)*cos(q2) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q2)*cos(q3) - sin(q1)*sin(q2)*cos(q2))*(icyy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + ixy*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + (2*ixy*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + 2*iyz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (icxx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ixy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (iczz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + iyz*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3))*(icxx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + icyy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + iyz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3))) + ((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(icyy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iczz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + ixy*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))))) - (sin(q2)^2 + sin(q3)^2*cos(q2)^2 + cos(q2)^2*cos(q3)^2)*(icxx*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + ixy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + izx*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + (2*ixy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + 2*izx*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) - (icyy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + iyz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + (iczz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + iyz*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)))*(icxx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + icyy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + iyz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3))) + ((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(icxx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + iczz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iyz*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -c1*u1*sin(q3) - c2*u2*cos(q3) + comz*g*m*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*sin(q3) - comz*g*m*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*cos(q3) + comz*m*(comx*u1*u2*cos(q2) - comz*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(u1*sin(q2) + u3))*sin(q3) - comz*m*(-comy*u1*u2*cos(q2) + comz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*sin(q2) + u3) + (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*cos(q3) + g*m*(-comx*cos(q3) + comy*sin(q3))*sin(q1)*cos(q2) - m*(-comx*cos(q3) + comy*sin(q3))*(-comx*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + comy*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) - (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - ((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*sin(q3) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*cos(q3))*(iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + iyz*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + izx*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + (2*iyz*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + 2*izx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (icxx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ixy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (icyy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + iyz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3))*(icxx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + iczz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iyz*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))) + (-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)))*(icyy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iczz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + ixy*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))))) - ((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*cos(q3) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*sin(q3))*(icyy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + ixy*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + (2*ixy*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + 2*iyz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (icxx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ixy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (iczz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + iyz*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3))*(icxx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + icyy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + iyz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3))) + ((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(icyy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iczz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + ixy*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))));
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -c3*u3 - comx*g*m*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - comx*m*(comx*u1*u2*cos(q2) - comz*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (-comy*(u1*sin(q2) + u3) + comz*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(u1*sin(q2) + u3)) + comy*g*m*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)) + comy*m*(-comy*u1*u2*cos(q2) + comz*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) - (comx*(u1*sin(q2) + u3) - comz*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(u1*sin(q2) + u3) + (-comx*(-u1*sin(q3)*cos(q2) + u2*cos(q3)) + comy*(u1*cos(q2)*cos(q3) + u2*sin(q3)))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (icxx*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + ixy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + izx*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + (2*ixy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + 2*izx*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) - (icyy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + iyz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + (iczz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + iyz*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)))*(icxx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + icyy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + iyz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3))) + ((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(icxx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + iczz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iyz*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))))*sin(q2) + (icyy*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + ixy*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + iyz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + (2*ixy*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + 2*iyz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (icxx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ixy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (iczz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) + iyz*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3))*(icxx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + icyy*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3))) + iyz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3))) + ((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3)))*(icyy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iczz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + ixy*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))))*sin(q1)*cos(q2) - (iczz*((sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + u1*u2*cos(q1)*cos(q2)^2) + iyz*((-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3))*(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3)) + (sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))*(-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3)) - u1*u2*sin(q1)*cos(q2)^2) + izx*(-(u1*u2*sin(q2)*sin(q3) - u1*u3*cos(q2)*cos(q3) - u2*u3*sin(q3))*sin(q3)*cos(q2) + (-u1*u2*sin(q2)*cos(q3) - u1*u3*sin(q3)*cos(q2) + u2*u3*cos(q3))*cos(q2)*cos(q3) + u1*u2*sin(q2)*cos(q2)) + (2*iyz*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + 2*izx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))))*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))) - (icxx*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ixy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + (icyy*(-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + iyz*((u1*sin(q2) + u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(u1*cos(q2)*cos(q3) + u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(-u1*sin(q3)*cos(q2) + u2*cos(q3))))*((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3)) + ((u1*sin(q2) + u3)*sin(q2) - (-u1*sin(q3)*cos(q2) + u2*cos(q3))*sin(q3)*cos(q2) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*cos(q2)*cos(q3))*(icxx*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + iczz*(-(-u1*sin(q2) - u3)*sin(q1)*cos(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + ixy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iyz*(-(-u1*sin(q2) - u3)*cos(q1)*cos(q2) - (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) - (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))) + (-(u1*sin(q2) + u3)*sin(q1)*cos(q2) + (-u1*sin(q3)*cos(q2) + u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) + (u1*cos(q2)*cos(q3) + u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1)))*(icyy*((-u1*sin(q2) - u3)*sin(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) + (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + iczz*(-(-u1*sin(q2) - u3)*sin(q2) + (u1*sin(q3)*cos(q2) - u2*cos(q3))*sin(q3)*cos(q2) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*cos(q2)*cos(q3)) + ixy*((-u1*sin(q2) - u3)*sin(q1)*cos(q2) - (u1*sin(q3)*cos(q2) - u2*cos(q3))*(-sin(q1)*sin(q2)*sin(q3) + cos(q1)*cos(q3)) - (-u1*cos(q2)*cos(q3) - u2*sin(q3))*(sin(q1)*sin(q2)*cos(q3) + sin(q3)*cos(q1))) + izx*((-u1*sin(q2) - u3)*cos(q1)*cos(q2) + (sin(q1)*sin(q3) - sin(q2)*cos(q1)*cos(q3))*(-u1*cos(q2)*cos(q3) - u2*sin(q3)) + (sin(q1)*cos(q3) + sin(q2)*sin(q3)*cos(q1))*(u1*sin(q3)*cos(q2) - u2*cos(q3)))))*cos(q1)*cos(q2)];
%%


R = mm\fo;
xd(1) = R(1);
xd(2) = R(2);
xd(3) = R(3);
xd(4) = R(4);
xd(5) = R(5);
xd(6) = R(6);